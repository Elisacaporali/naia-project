import re
import random


remedios_cadastrados = {}
contato_emergencia = ""
numero_emergencia = "" 
nome = ""
horarios_medicamentos = []


def get_greeting():
        return "Ol√°, meu nome √© N.A.I.A! Como devo lhe chamar?"

def process_user_name(nome):
        nome = nome.strip()
        return f"Prazer em conhec√™-lo, {nome}! Como voc√™ est√° se sentindo hoje?"

def analyze_feeling(sentimento):
        sentimento = sentimento.strip().lower()
        if sentimento in ['triste', 'mau', 'mal', 'ruim', 'cansado', 'desanimado', 'estressado', 'sobrecarregado', 'preocupado']:
            return "√â normal se sentir assim √†s vezes. Que tal pensar com mais carinho naquilo que te afeta?"
        elif sentimento in ['bem', 'feliz', 'animado', 'contente', 'alegre', '√≥timo', 'inspirado', 'otimista']:
            return "Que bom que se sente assim! Se voc√™ est√° bem, eu me sinto bem."
        elif sentimento in ['ok', 'normal', 'mais ou menos', 'regular', 'tanto faz', 'indiferente', 'na mesma']:
            return "Certo! Tentarei ajudar da melhor forma poss√≠vel."
            
        else:
            return "Certo! Tentarei ajudar da melhor forma poss√≠vel."

def neurodivergence_options():
        return [

            "Voc√™ possui algum perfil neurodivergente?\n",
            "1. TEA",
            "2. TDAH",
            "3. Nenhum dos acima",
            "4. Sair"
        ]
            
        

def process_neurodivergence(option):
        if option in ["1", "2"]:
            return perguntar_remedio()
        elif option == "3":
            return outros_transtornos()
        
        elif option == "4":
            return sair()
        
        return "Marque uma das op√ß√µes: 1, 2, 3 ou 4. \n" + neurodivergence_options() 


def outros_transtornos():
      return "Qual outro transtorno voc√™ possui?"



def perguntar_remedio():
        return "Voc√™ toma algum medicamento? (sim/n√£o)"



def cadastrar_remedios(remedio, dosagem, horario):
        try:
        # Adiciona ou atualiza a dosagem do medicamento no dicion√°rio
            remedios_cadastrados[remedio] = dosagem
            horarios_medicamentos.append(horario)
            return f"Medicamento {remedio} com dosagem {dosagem} e no hor√°rio {horario} armazenado com sucesso. Informe outro medicamento ou digite 'fim'."
        except Exception as e:
            return f"Erro ao cadastrar medicamento: {str(e)}"

def listar_medicamentos():
    if not remedios_cadastrados:
        return "Nenhum medicamento cadastrado."
    
    lista_medicamentos = "\n".join([f"{remedio}: {dosagem}" for remedio, dosagem in remedios_cadastrados.items()])
    return f"Medicamentos cadastrados:\n{lista_medicamentos}"

def opcoes_remedios(option):
        if option.lower() == "sim":
            return "Quais medicamentos voc√™ toma? Informe o nome e a dosagem e o hor√°rio (exemplo: Paracetamol 500mg e 10h)"
        elif option.lower() == "n√£o":
            return perguntar_se_deseja_cadastrar_contato()
        else:
            return "N√£o entendi. Por favor, responda com 'sim' ou 'n√£o'."


def perguntar_se_deseja_cadastrar_contato():
    return "Deseja informar um contato de emerg√™ncia? (sim/n√£o)"


def informar_contato():
    return {"status": "success", "message": "Contato informado com sucesso"}


def nome_contato(nome):
        contato_emergencia = nome
        return f"Voc√™ escolheu o contato: {nome}"

def informar_numero():
        return "Informe o n√∫mero do contato de emerg√™ncia."

def numero_contato(numero):
        numero_emergencia = numero
        return "Contato de emerg√™ncia configurado!"




def menu():
        return [
            "Escolha uma op√ß√£o: \n",
            "1 - Nome da pessoa \n",
            "2 - Lista de medicamentos e dosagem \n",
            "3 - Contato de emerg√™ncia \n",
            "4 - Pausa para medita√ß√£o \n",
            "5 - Sugest√µes de rotina \n"
            "6 - Fale com a N.A.I.A \n",
            "7 - Sair"
        ]


def sair():
        return "Obrigado por testar a N.A.I.A em primeira m√£o."

def nome_usuario(nome):
        return f"Nome da pessoa: {nome}"

def listar_medicamentos():
    if not remedios_cadastrados:
        print("Nenhum medicamento cadastrado.")  # Log para depura√ß√£o
        return "Nenhum medicamento cadastrado."
    
    lista_medicamentos = "\n".join([f"{remedio}: {dosagem}" for remedio, dosagem in remedios_cadastrados.items()])
    print(f"Lista de medicamentos: {lista_medicamentos}")  # Log para depura√ß√£o
    return f"Medicamentos cadastrados:\n{lista_medicamentos}"
    


def listar_contato():
        return f"Nome do contato de emerg√™ncia: {contato_emergencia}\nN√∫mero do contato de emerg√™ncia: {numero_emergencia}"


def meditacao():
        return "Pausa de medita√ß√£o de 15 segundos."


def sugestao_rotina():
    try:
        rotinas = [
                "üåÖ Manh√£ tranquila: Acorde no mesmo hor√°rio todos os dias, fa√ßa alongamentos leves e tome um caf√© da manh√£ nutritivo.",
                "üìÖ Planejamento do dia: Use um planner ou aplicativo para organizar suas tarefas e evitar sobrecarga mental.",
                "üéß Momentos de descanso: Separe per√≠odos curtos durante o dia para ouvir m√∫sica relaxante ou praticar mindfulness.",
                "üßò Exerc√≠cio e bem-estar: Fa√ßa atividades f√≠sicas adaptadas √†s suas necessidades, como yoga, caminhada ou dan√ßa.",
                "üçΩÔ∏è Alimenta√ß√£o estruturada: Estabele√ßa hor√°rios fixos para refei√ß√µes e evite distra√ß√µes para uma melhor digest√£o.",
                "üíª Trabalho/Estudo: Divida suas tarefas em blocos de 25 a 50 minutos com pausas para manter o foco.",
                "üîá Redu√ß√£o de est√≠mulos: Crie um ambiente tranquilo para momentos de concentra√ß√£o, reduzindo barulhos e luzes fortes.",
                "üìö Tempo para interesses especiais: Dedique um momento do dia para explorar um hobby ou aprender algo novo.",
                "üòå Relaxamento noturno: Crie uma rotina de sono consistente, evitando telas antes de dormir e praticando respira√ß√£o profunda.",
                "üìù Descompress√£o: Antes de dormir, anote pensamentos ou preocupa√ß√µes para aliviar a mente e facilitar o sono."
        ]
        
        return random.choice(rotinas)     

    except Exception as e:
            print(e)
            return f"Erro ao sugerir rotina: {str(e)}"  


def falar_com_naia(text):
    try:
        perguntas_respostas = {
            # Perguntas sobre TEA
        "O que √© TEA?": "O Transtorno do Espectro Autista (TEA) √© uma condi√ß√£o neurol√≥gica que afeta a comunica√ß√£o e o comportamento.",
        "Quais s√£o os principais sinais do TEA?": "Dificuldade na intera√ß√£o social, comunica√ß√£o at√≠pica e comportamentos repetitivos.",
        "O TEA pode ser diagnosticado em adultos?": "Sim, embora o diagn√≥stico seja mais comum na inf√¢ncia, muitos adultos descobrem tardiamente que t√™m TEA.",
        "O TEA afeta a intelig√™ncia?": "N√£o necessariamente. Algumas pessoas t√™m d√©ficits intelectuais, enquanto outras t√™m habilidades acima da m√©dia.",
        "O que significa ser 'autista n√≠vel 1, 2 ou 3'?": "√â uma classifica√ß√£o baseada no n√≠vel de suporte necess√°rio, sendo 1 o mais leve e 3 o mais intenso.",
        "O autismo tem cura?": "N√£o, mas interven√ß√µes terap√™uticas ajudam a melhorar a qualidade de vida.",
        "Toda pessoa com TEA tem hipersensibilidade sensorial?": "N√£o, algumas t√™m hipersensibilidade (a sons, luzes, cheiros), mas outras podem ter hipossensibilidade.",
        "O TEA afeta a comunica√ß√£o verbal?": "Algumas pessoas s√£o n√£o verbais, outras t√™m dificuldades sutis na fala, e algumas falam normalmente.",
        "O que √© a s√≠ndrome de Asperger?": "√â um tipo de TEA caracterizado por dificuldades sociais, mas sem atraso significativo na fala.",
        "Como posso apoiar algu√©m com TEA?": "Ser paciente, respeitar limites sensoriais e comunicar-se de forma clara e objetiva.",
        
        # Perguntas sobre TDAH
        "O que √© TDAH?": "Transtorno do D√©ficit de Aten√ß√£o e Hiperatividade, que afeta a aten√ß√£o, impulsividade e hiperatividade.",
        "Quais s√£o os principais sintomas do TDAH?": "Dificuldade de concentra√ß√£o, impulsividade e inquieta√ß√£o excessiva.",
        "O TDAH afeta apenas crian√ßas?": "N√£o, adultos tamb√©m podem ter TDAH, muitas vezes sem diagn√≥stico.",
        "O TDAH pode ser tratado?": "Sim, com terapia comportamental, ajustes na rotina e, em alguns casos, medica√ß√£o.",
        "Quem pode diagnosticar TDAH?": "Psiquiatras e neuropsic√≥logos s√£o os profissionais mais indicados para o diagn√≥stico.",
        "TDAH est√° relacionado √† intelig√™ncia?": "N√£o, pessoas com TDAH podem ter qualquer n√≠vel de intelig√™ncia.",
        "Pessoas com TDAH t√™m dificuldade em concluir tarefas?": "Sim, √© comum a procrastina√ß√£o e a dificuldade em manter o foco por longos per√≠odos.",
        "O que pode ajudar no TDAH sem uso de rem√©dios?": "Rotinas estruturadas, exerc√≠cios f√≠sicos e t√©cnicas de organiza√ß√£o podem ajudar bastante.",
        "O TDAH √© heredit√°rio?": "Sim, pesquisas indicam que h√° um forte componente gen√©tico no TDAH.",
        "Pessoas com TDAH s√£o sempre hiperativas?": "N√£o, existem subtipos, incluindo o desatento, que n√£o apresenta hiperatividade.",
        
        # Perguntas de conhecimento geral
        "Qual √© o maior planeta do sistema solar?": "J√∫piter √© o maior planeta do sistema solar.",
        "Quem descobriu o Brasil?": "O Brasil foi oficialmente descoberto por Pedro √Ålvares Cabral em 1500.",
        "Qual √© a capital da Fran√ßa?": "A capital da Fran√ßa √© Paris.",
        "Quem pintou a Mona Lisa?": "A Mona Lisa foi pintada por Leonardo da Vinci.",
        "Quantos continentes existem?": "Existem seis continentes: Am√©rica, √Åfrica, Europa, √Åsia, Oceania e Ant√°rtida.",
        "O que √© fotoss√≠ntese?": "√â o processo pelo qual as plantas produzem energia a partir da luz solar.",
        "Quem foi Albert Einstein?": "Einstein foi um f√≠sico famoso pela Teoria da Relatividade.",
        "O que significa a sigla ONU?": "ONU significa Organiza√ß√£o das Na√ß√µes Unidas.",
        "Quantos ossos tem o corpo humano?": "O corpo humano adulto tem 206 ossos.",
        "Qual √© o elemento qu√≠mico mais abundante no universo?": "O hidrog√™nio √© o elemento mais abundante no universo.",
        "Quem escreveu Dom Quixote?": "O livro Dom Quixote foi escrito por Miguel de Cervantes.",
        "Qual √© o animal mais r√°pido do mundo?": "O falc√£o-peregrino √© o animal mais r√°pido do mundo, podendo atingir 390 km/h em mergulho.",
        "O que significa CPU?": "CPU significa Unidade Central de Processamento, o c√©rebro do computador.",
        "Quem foi o primeiro homem a pisar na Lua?": "Neil Armstrong foi o primeiro homem a pisar na Lua, em 1969.",
        "Qual √© o metal mais leve do mundo?": "O l√≠tio √© o metal mais leve conhecido.",
        "Qual √© o maior oceano do planeta?": "O maior oceano √© o Oceano Pac√≠fico.",
        "Quem foi o criador do telefone?": "Alexander Graham Bell √© creditado como o inventor do telefone.",
        "O que √© um ano-luz?": "Ano-luz √© a dist√¢ncia que a luz percorre no v√°cuo em um ano, aproximadamente 9,46 trilh√µes de quil√¥metros.",
        "Qual √© a montanha mais alta do mundo?": "O Monte Everest √© a montanha mais alta do mundo, com 8.848 metros de altitude.",
        "O que significa WWW?": "WWW significa World Wide Web, a teia mundial de computadores.",
        "Quem escreveu Harry Potter?": "A s√©rie Harry Potter foi escrita por J.K. Rowling.",
        "Quantos dentes tem um ser humano adulto?": "Um ser humano adulto tem 32 dentes.",
        "O que √© uma c√©lula?": "A c√©lula √© a unidade b√°sica da vida, presente em todos os seres vivos.",
        "O que significa DNA?": "DNA significa √Åcido Desoxirribonucleico, respons√°vel pelo c√≥digo gen√©tico dos seres vivos.",
        "Qual √© o maior deserto do mundo?": "O maior deserto do mundo √© a Ant√°rtida, seguido pelo Deserto do Saara.",

        # Perguntas sobre psicologia
        "O que √© ansiedade?": "Ansiedade √© uma resposta natural do corpo ao estresse, podendo ser ben√©fica em algumas situa√ß√µes.",
        "O que √© a resili√™ncia emocional?": "Resili√™ncia emocional √© a capacidade de se recuperar rapidamente de dificuldades e adversidades.",
        "O que √© a cogni√ß√£o?": "Cogni√ß√£o √© o conjunto de processos mentais envolvidos na aquisi√ß√£o de conhecimento e compreens√£o.",
        "Como funciona o condicionamento cl√°ssico?": "√â um tipo de aprendizado no qual um est√≠mulo neutro passa a evocar uma resposta ap√≥s ser associado a um est√≠mulo incondicionado.",
        "O que √© refor√ßo positivo?": "Refor√ßo positivo √© a adi√ß√£o de um est√≠mulo agrad√°vel para aumentar a probabilidade de um comportamento ocorrer novamente.",
        "O que √© refor√ßo negativo?": "Refor√ßo negativo √© a remo√ß√£o de um est√≠mulo desagrad√°vel para aumentar a ocorr√™ncia de um comportamento desejado.",
        "O que √© a teoria do apego?": "√â uma teoria que explica como os v√≠nculos emocionais entre indiv√≠duos se formam e influenciam o desenvolvimento.",
        "O que √© mem√≥ria de curto prazo?": "√â a capacidade de armazenar pequenas quantidades de informa√ß√£o por um curto per√≠odo.",
        "O que √© mem√≥ria de longo prazo?": "√â o armazenamento duradouro de informa√ß√µes e experi√™ncias adquiridas ao longo da vida.",
        "O que √© transtorno obsessivo-compulsivo (TOC)?": "√â um transtorno caracterizado por obsess√µes e compuls√µes que interferem na vida di√°ria.",
        "O que √© um vi√©s cognitivo?": "S√£o padr√µes sistem√°ticos de desvios do pensamento l√≥gico que afetam a tomada de decis√£o.",
        "O que √© a teoria das intelig√™ncias m√∫ltiplas?": "√â uma teoria proposta por Howard Gardner que sugere a exist√™ncia de diferentes tipos de intelig√™ncia.",
        "O que √© a psicologia positiva?": "√â um ramo da psicologia focado no estudo das emo√ß√µes positivas, for√ßas e virtudes humanas.",
        "O que √© a teoria da disson√¢ncia cognitiva?": "√â a ideia de que os indiv√≠duos sentem desconforto quando possuem cren√ßas ou comportamentos contradit√≥rios.",
        "O que √© empatia?": "Empatia √© a capacidade de compreender e compartilhar os sentimentos de outra pessoa.",
        "O que √© transtorno bipolar?": "√â um transtorno mental caracterizado por mudan√ßas extremas de humor, variando entre epis√≥dios de mania e depress√£o.",
        "O que √© a psican√°lise?": "√â um m√©todo terap√™utico criado por Freud que busca explorar o inconsciente para entender o comportamento humano.",
        "O que √© o efeito placebo?": "√â um fen√¥meno no qual uma subst√¢ncia sem efeito real provoca uma melhora por conta da expectativa do paciente.",
        "O que √© um transtorno de personalidade?": "S√£o padr√µes persistentes de comportamento e experi√™ncia interna que desviam significativamente das normas culturais.",
        "O que √© a autoefic√°cia?": "√â a cren√ßa na pr√≥pria capacidade de realizar tarefas e alcan√ßar objetivos.",
        "O que √© o transtorno de estresse p√≥s-traum√°tico (TEPT)?": "√â um transtorno causado por experi√™ncias traum√°ticas, resultando em sintomas como flashbacks e ansiedade intensa.",
        "O que √© o efeito de grupo?": "√â a tend√™ncia das pessoas de conformarem suas opini√µes e comportamentos ao grupo ao qual pertencem.",
        "O que √© o desenvolvimento cognitivo?": "√â o processo pelo qual as habilidades intelectuais evoluem ao longo da vida.",
        "O que √© neuroplasticidade?": "√â a capacidade do c√©rebro de se reorganizar formando novas conex√µes neurais.",
        "O que √© a s√≠ndrome de burnout?": "√â um estado de exaust√£o emocional, f√≠sica e mental causado pelo estresse cr√¥nico no trabalho.",
        "O que √© o transtorno de ansiedade generalizada (TAG)?": "√â um transtorno caracterizado por preocupa√ß√£o excessiva e dificuldade em controlar a ansiedade.",
        "O que √© o efeito halo?": "√â a tend√™ncia de avaliar uma pessoa de forma positiva ou negativa com base em uma √∫nica caracter√≠stica.",
        "O que √© a hierarquia das necessidades de Maslow?": "√â uma teoria psicol√≥gica que prop√µe uma hierarquia de necessidades humanas, desde b√°sicas at√© autorrealiza√ß√£o.",
        "O que √© o efeito Pigmali√£o?": "√â o fen√¥meno em que as expectativas de uma pessoa influenciam o desempenho de outra.",


        "O que √© mindfulness?": "Mindfulness √© a pr√°tica de estar presente e consciente no momento, sem julgamentos.",
        "O que √© um algoritmo?": "Um algoritmo √© uma sequ√™ncia de passos l√≥gicos para resolver um problema ou realizar uma tarefa.",
        "O que √© intelig√™ncia artificial?": "Intelig√™ncia artificial √© o campo da ci√™ncia da computa√ß√£o que busca criar m√°quinas capazes de imitar a intelig√™ncia humana.",
        "O que √© machine learning?": "Machine learning √© uma √°rea da intelig√™ncia artificial que ensina computadores a aprenderem com dados sem serem explicitamente programados.",
        "O que √© blockchain?": "Blockchain √© uma tecnologia de registro distribu√≠do que garante seguran√ßa e transpar√™ncia em transa√ß√µes digitais.",
        "O que √© computa√ß√£o em nuvem?": "Computa√ß√£o em nuvem √© a entrega de servi√ßos de computa√ß√£o, como armazenamento e processamento, pela internet.",
        "O que √© um banco de dados?": "Um banco de dados √© um sistema que armazena, organiza e gerencia dados de forma eficiente.",
        "O que √© ciberseguran√ßa?": "Ciberseguran√ßa √© a pr√°tica de proteger sistemas, redes e dados contra ataques digitais.",
        "O que √© um sistema operacional?": "Um sistema operacional √© um software que gerencia os recursos de hardware e software de um computador.",
        "O que √© um protocolo de rede?": "Um protocolo de rede √© um conjunto de regras que define como os dispositivos se comunicam em uma rede.",
        "O que √© um firewall?": "Um firewall √© um sistema de seguran√ßa que monitora e controla o tr√°fego de rede com base em regras de seguran√ßa.",
        "O que √© um servidor?": "Um servidor √© um computador que fornece servi√ßos ou recursos para outros dispositivos em uma rede.",
    }


        # Normalizar o texto de entrada
        text = text.strip().casefold()  # casefold() √© melhor para compara√ß√£o de strings

        for key in perguntas_respostas:
            key_normalized = key.casefold()  # Normaliza as chaves tamb√©m
            if re.search(re.escape(key_normalized), text):  # Busca sem \b para mais flexibilidade
                return perguntas_respostas[key]

        return "Desculpe, n√£o entendi a sua pergunta. Poderia reformular?"
    
    except Exception as e:
        return f"Erro ao processar pergunta: {str(e)}"

def sair():
        return "Obrigado por testar a N.A.I.A em primeira m√£o."


def iniciar_menu(option, nome=None, text=None):
    options_map = {
        "1": lambda: nome_usuario(nome),  # Passa o nome como argumento
        "2": listar_medicamentos,        # Fun√ß√£o sem argumentos
        "3": listar_contato,             # Fun√ß√£o sem argumentos
        "4": meditacao,                  # Fun√ß√£o sem argumentos
        "5": sugestao_rotina,            # Passa o texto como argumento
        "6": lambda: falar_com_naia(text),  # Fun√ß√£o sem argumentos
        "7": sair                        # Fun√ß√£o sem argumentos
    }
    
    # Obt√©m a fun√ß√£o correspondente √† op√ß√£o
    selected_function = options_map.get(option)
    
    if selected_function:
        return selected_function()  # Executa a fun√ß√£o
    else:
        return "Op√ß√£o inv√°lida. Por favor, escolha uma das op√ß√µes: 1, 2, 3, 4, 5, 6 ou 7."
    





def verificar_estado_do_usuario(text):
    if not text:
        return False
    
    try:
        palavras_negativas = {"crise", "crise de ansiedade", "p√¢nico", "depress√£o", "triste", "desesperado", "angustiado", "sufocado", "medo", "ansioso", "desamparado", "exausto",
                              "sobrecarregado", "inseguro", "aflito", "perturbado", "frustrado", "solit√°rio", "desmotivado", "abatido", "desesperan√ßoso", 
                              "oprimido", "confuso", "vulner√°vel", "desorientado", "cansado", "fragilizado", "desolado", "desgostoso", "ap√°tico", "desconfort√°vel", "irritado", "agonizado", "oprimido", "sufocante"}
        
        texto_lower = text.lower()
        
        

        for palavra in palavras_negativas:
            if palavra in texto_lower:
                return True
        
        return False
    
    except Exception as e:
          print(f"Erro na fun√ß√£o: {str(e)}")
      

      
